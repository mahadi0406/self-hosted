// 1. create_admins_table
Schema::create('admins', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('email')->unique();
    $table->string('password');
    $table->string('two_factor_secret')->nullable();
    $table->boolean('two_factor_enabled')->default(false);
    $table->rememberToken();
    $table->timestamps();
});

// 2. create_validation_results_table
Schema::create('validation_results', function (Blueprint $table) {
    $table->id();
    $table->string('email');
    $table->boolean('is_valid')->default(false);
    $table->integer('score')->default(0);
    $table->json('checks'); // all validation check results
    $table->string('status'); // valid, invalid, risky
    $table->string('suggestion')->nullable(); // typo suggestion
    $table->foreignId('list_id')->nullable()->constrained('saved_lists')->onDelete('cascade');
    $table->timestamps();
    $table->index('email');
    $table->index('is_valid');
    $table->index('created_at');
});

// 3. create_saved_lists_table
Schema::create('saved_lists', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->text('description')->nullable();
    $table->integer('total_emails')->default(0);
    $table->integer('valid_emails')->default(0);
    $table->integer('invalid_emails')->default(0);
    $table->string('tags')->nullable(); // comma separated
    $table->string('status'); // processing, completed, failed
    $table->timestamps();
});

// 4. create_disposable_domains_table
Schema::create('disposable_domains', function (Blueprint $table) {
    $table->id();
    $table->string('domain')->unique();
    $table->boolean('is_active')->default(true);
    $table->timestamps();
    $table->index('domain');
});

// 5. create_free_email_providers_table
Schema::create('free_email_providers', function (Blueprint $table) {
    $table->id();
    $table->string('domain')->unique();
    $table->boolean('is_active')->default(true);
    $table->timestamps();
});

// 6. create_role_based_keywords_table
Schema::create('role_based_keywords', function (Blueprint $table) {
    $table->id();
    $table->string('keyword')->unique();
    $table->boolean('is_active')->default(true);
    $table->timestamps();
});

// 7. create_api_keys_table
Schema::create('api_keys', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('key')->unique();
    $table->integer('requests_limit')->default(1000);
    $table->integer('requests_used')->default(0);
    $table->boolean('is_active')->default(true);
    $table->timestamp('last_used_at')->nullable();
    $table->timestamps();
});

// 8. create_api_logs_table
Schema::create('api_logs', function (Blueprint $table) {
    $table->id();
    $table->foreignId('api_key_id')->constrained()->onDelete('cascade');
    $table->string('endpoint');
    $table->string('method');
    $table->ipAddress('ip_address');
    $table->integer('response_code');
    $table->timestamps();
    $table->index('created_at');
});

// 9. create_settings_table
Schema::create('settings', function (Blueprint $table) {
    $table->id();
    $table->string('key')->unique();
    $table->text('value')->nullable();
    $table->timestamps();
});

// 10. create_validation_templates_table
Schema::create('validation_templates', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->json('rules'); // enabled checks configuration
    $table->boolean('is_default')->default(false);
    $table->timestamps();
});

// 11. create_scheduled_validations_table
Schema::create('scheduled_validations', function (Blueprint $table) {
    $table->id();
    $table->foreignId('list_id')->constrained('saved_lists')->onDelete('cascade');
    $table->dateTime('scheduled_at');
    $table->string('status'); // pending, running, completed, failed
    $table->foreignId('template_id')->nullable()->constrained('validation_templates')->onDelete('set null');
    $table->timestamps();
});

// 12. create_activity_logs_table
Schema::create('activity_logs', function (Blueprint $table) {
    $table->id();
    $table->foreignId('admin_id')->constrained()->onDelete('cascade');
    $table->string('action');
    $table->text('description')->nullable();
    $table->ipAddress('ip_address')->nullable();
    $table->string('user_agent')->nullable();
    $table->timestamps();
    $table->index('created_at');
});

// 13. create_webhooks_table
Schema::create('webhooks', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('url');
    $table->string('event'); // validation_completed, list_completed
    $table->boolean('is_active')->default(true);
    $table->timestamps();
});

// 14. create_webhook_logs_table
Schema::create('webhook_logs', function (Blueprint $table) {
    $table->id();
    $table->foreignId('webhook_id')->constrained()->onDelete('cascade');
    $table->integer('response_code')->nullable();
    $table->text('response_body')->nullable();
    $table->timestamps();
});

// 15. create_backups_table
Schema::create('backups', function (Blueprint $table) {
    $table->id();
    $table->string('filename');
    $table->string('path');
    $table->bigInteger('size'); // in bytes
    $table->string('type'); // full, lists_only, settings_only
    $table->timestamps();
});

// 16. create_domain_reputation_table
Schema::create('domain_reputation', function (Blueprint $table) {
    $table->id();
    $table->string('domain')->unique();
    $table->integer('score')->default(50); // 0-100
    $table->integer('total_validations')->default(0);
    $table->integer('valid_count')->default(0);
    $table->integer('invalid_count')->default(0);
    $table->boolean('is_blacklisted')->default(false);
    $table->timestamps();
    $table->index('domain');
});

// 17. create_export_history_table
Schema::create('export_history', function (Blueprint $table) {
    $table->id();
    $table->foreignId('list_id')->nullable()->constrained('saved_lists')->onDelete('cascade');
    $table->string('format'); // csv, excel, json, pdf
    $table->string('filename');
    $table->string('path')->nullable();
    $table->integer('records_count');
    $table->timestamps();
});

// 18. create_ftp_configurations_table
Schema::create('ftp_configurations', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('host');
    $table->integer('port')->default(21);
    $table->string('username');
    $table->string('password');
    $table->string('directory')->default('/');
    $table->boolean('is_active')->default(true);
    $table->timestamps();
});
// 19. create_email_campaigns_table
Schema::create('email_campaigns', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('subject');
    $table->text('body_html');
    $table->foreignId('list_id')->nullable()->constrained('saved_lists')->onDelete('set null');
    $table->string('from_email')->nullable();
    $table->string('status')->default('draft'); // draft, scheduled, sending, sent, paused
    $table->timestamp('scheduled_at')->nullable();
    $table->timestamp('sent_at')->nullable();
    $table->integer('total_sent')->default(0);
    $table->integer('total_opened')->default(0);
    $table->integer('total_clicked')->default(0);
    $table->boolean('is_ai_generated')->default(false);
    $table->timestamps();
});

// 20. create_email_sequences_table (Drip Campaigns)
Schema::create('email_sequences', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->text('description')->nullable();
    $table->foreignId('list_id')->nullable()->constrained('saved_lists')->onDelete('set null');
    $table->string('status')->default('draft'); // draft, active, paused
    $table->integer('total_subscribers')->default(0);
    $table->timestamps();
});

// 21. create_sequence_steps_table
Schema::create('sequence_steps', function (Blueprint $table) {
    $table->id();
    $table->foreignId('sequence_id')->constrained('email_sequences')->onDelete('cascade');
    $table->integer('step_order')->default(1);
    $table->string('subject');
    $table->text('body_html');
    $table->integer('delay_days')->default(0);
    $table->string('condition')->nullable(); // opened_previous, clicked_previous, none
    $table->boolean('is_ai_generated')->default(false);
    $table->timestamps();
});

// 22. create_sequence_subscribers_table
Schema::create('sequence_subscribers', function (Blueprint $table) {
    $table->id();
    $table->foreignId('sequence_id')->constrained('email_sequences')->onDelete('cascade');
    $table->string('email');
    $table->string('status')->default('active'); // active, paused, completed, unsubscribed
    $table->integer('current_step')->default(0);
    $table->timestamp('enrolled_at');
    $table->timestamp('next_send_at')->nullable();
    $table->timestamp('completed_at')->nullable();
    $table->timestamps();
});

// 23. create_campaign_recipients_table
Schema::create('campaign_recipients', function (Blueprint $table) {
    $table->id();
    $table->foreignId('campaign_id')->constrained('email_campaigns')->onDelete('cascade');
    $table->string('email');
    $table->string('status')->default('pending'); // pending, sent, opened, clicked, bounced
    $table->timestamp('sent_at')->nullable();
    $table->timestamp('opened_at')->nullable();
    $table->timestamp('clicked_at')->nullable();
    $table->integer('open_count')->default(0);
    $table->integer('click_count')->default(0);
    $table->timestamps();
});

// 24. create_email_templates_table
Schema::create('email_templates', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('category')->default('general'); // welcome, promotional, newsletter, follow_up
    $table->string('subject');
    $table->text('body_html');
    $table->boolean('is_ai_generated')->default(false);
    $table->integer('usage_count')->default(0);
    $table->timestamps();
});

// 25. create_contact_engagement_table
Schema::create('contact_engagement', function (Blueprint $table) {
    $table->id();
    $table->string('email')->unique();
    $table->string('first_name')->nullable();
    $table->string('last_name')->nullable();
    $table->integer('engagement_score')->default(0); // 0-100
    $table->string('engagement_level')->default('cold'); // hot, warm, cold
    $table->integer('total_sent')->default(0);
    $table->integer('total_opened')->default(0);
    $table->integer('total_clicked')->default(0);
    $table->timestamp('last_sent_at')->nullable();
    $table->timestamp('last_opened_at')->nullable();
    $table->timestamps();
});

// 26. create_email_tracking_table
Schema::create('email_tracking', function (Blueprint $table) {
    $table->id();
    $table->foreignId('campaign_id')->nullable()->constrained('email_campaigns')->onDelete('cascade');
    $table->string('email');
    $table->string('event_type'); // sent, opened, clicked, bounced
    $table->string('link_url')->nullable();
    $table->ipAddress('ip_address')->nullable();
    $table->timestamps();
});

// 27. create_unsubscribes_table
Schema::create('unsubscribes', function (Blueprint $table) {
    $table->id();
    $table->string('email')->unique();
    $table->string('reason')->nullable();
    $table->timestamps();
});

// 28. create_smtp_providers_table
Schema::create('smtp_providers', function (Blueprint $table) {
    $table->id();
    $table->string('name');
    $table->string('host');
    $table->integer('port')->default(587);
    $table->string('username');
    $table->string('password');
    $table->string('encryption')->default('tls'); // tls, ssl
    $table->integer('daily_limit')->default(500);
    $table->integer('daily_sent')->default(0);
    $table->boolean('is_active')->default(true);
    $table->timestamps();
});

// 29. create_ai_content_history_table
Schema::create('ai_content_history', function (Blueprint $table) {
    $table->id();
    $table->text('prompt');
    $table->string('content_type'); // subject, email_body, template
    $table->text('generated_content');
    $table->integer('rating')->nullable(); // 1-5 stars
    $table->boolean('was_used')->default(false);
    $table->timestamps();
});
```

---

## ğŸ“Š Summary: 11 New Tables Added

**Total Tables: 29** (18 original + 11 new)

### **New Marketing Tables:**

19. **email_campaigns** - Store campaigns
20. **email_sequences** - Drip campaigns container
21. **sequence_steps** - Individual emails in sequence
22. **sequence_subscribers** - Who's enrolled + progress
23. **campaign_recipients** - Track individual sends
24. **email_templates** - Reusable templates
25. **contact_engagement** - Contact health scores
26. **email_tracking** - Opens, clicks, bounces
27. **unsubscribes** - Opt-out list
28. **smtp_providers** - Email sending config
29. **ai_content_history** - AI generated content log

---

## âœ… What Each Table Does (Simple Explanation)

### **Campaigns:**
- `email_campaigns` â†’ One-time email blasts
- `campaign_recipients` â†’ Who got what email

### **Drip Sequences:**
- `email_sequences` â†’ The sequence container
- `sequence_steps` â†’ Each email in the sequence
- `sequence_subscribers` â†’ Track progress per person

### **Content:**
- `email_templates` â†’ Pre-made email designs
- `ai_content_history` â†’ Log of AI-generated emails

### **Tracking:**
- `email_tracking` â†’ Every open/click event
- `contact_engagement` â†’ Overall contact score

### **Management:**
- `unsubscribes` â†’ People who opted out
- `smtp_providers` â†’ How to send emails

---

## ğŸ¯ Key Simplifications (vs SaaS version)

**Removed:**
- âŒ Multi-tenant fields
- âŒ Complex A/B testing
- âŒ Advanced workflow conditions
- âŒ Multiple SMTP failover
- âŒ Bounce categorization
- âŒ Detailed analytics breakdowns
- âŒ Custom field mapping
- âŒ API webhook integrations

**Kept:**
- âœ… AI Email Writer
- âœ… Drip Sequences (core automation)
- âœ… Basic tracking (opens, clicks)
- âœ… Engagement scores
- âœ… Templates
- âœ… SMTP configuration
- âœ… Unsubscribe management

---

## ğŸ“‹ Quick Reference

### **For AI Email Writer:**
```
ai_content_history â†’ Stores generated emails
email_templates â†’ Save AI emails as templates
```

### **For Campaigns:**
```
email_campaigns â†’ Create campaign
campaign_recipients â†’ Add recipients
email_tracking â†’ Track results
```

### **For Drip Sequences:**
```
email_sequences â†’ Create sequence
sequence_steps â†’ Add emails (Email 1, 2, 3...)
sequence_subscribers â†’ Enroll people
email_tracking â†’ Track opens/clicks
```

### **For Analytics:**
```
contact_engagement â†’ Individual scores
email_tracking â†’ All events
campaign_recipients â†’ Campaign-specific stats
